<!DOCTYPE html>
<!-- saved from url=(0043)http://hl7.org/fhir/2016May/FHIRPath.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>

  <title>4. Logical Specification</title>

  
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="http://cql.hl7.org" name="author"/>

  <link rel="stylesheet" href="dist/fhir.css"/>
  <link rel="Prev" href="history.html"/>

    <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="dist/bootstrap.css"/>
  <link rel="stylesheet" href="dist/bootstrap-fhir.css"/>

    <!-- Project extras -->
  <link rel="stylesheet" href="dist/project.css"/>
  <link rel="stylesheet" href="dist/pygments-manni.css"/>
	<link rel="stylesheet" href="dist/jquery-ui.css"/>
	<link rel="stylesheet" href="dist/cql.css"/>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- [if lt IE 9]>
  <script src="./assets/js/html5shiv.js"></script>
  <script src="./assets/js/respond.min.js"></script>
  <![endif] -->

    <!-- Favicons -->
  <link sizes="144x144" rel="apple-touch-icon-precomposed" href="dist/apple-touch-icon-144-precomposed.png"/>
  <link sizes="114x114" rel="apple-touch-icon-precomposed" href="dist/apple-touch-icon-114-precomposed.png"/>
  <link sizes="72x72" rel="apple-touch-icon-precomposed" href="dist/apple-touch-icon-72-precomposed.png"/>
  <link rel="apple-touch-icon-precomposed" href="dist/apple-touch-icon-57-precomposed.png"/>
  <link rel="shortcut icon" href="dist/favicon.png"/>
  
</head>
<body data-feedly-mini="yes">
	<div id="segment-header" class="segment">  <!-- segment-header -->	
		<div class="container">  <!-- container -->
			<a id="logo" no-external="true" href="index.html"><img alt="logo hl7" src="dist/hl7-logo.png"/> </a>
			<div id="hl7-status">
				<b>Clinical Quality Language Release 1 STU2 (w/ Errata) (1.2.1)</b>
			</div>       	
			
			<div id="hl7-nav">
				 <a id="hl7-logo" no-external="true" href="http://www.hl7.org/">
					<img height="50" alt="visit the hl7 website" width="42" src="dist/hl7-logo.png"/>
				</a> 
			</div>       	
			<!--<div id="hl7-nav"><a id="hl7-logo" no-external="true" href="http://cql.hl7.org/STU2/search.cfm"><img alt="Search CQL" src="dist/search.png"/></a></div>-->
		</div>
		<div class="container">  <!-- container -->
	</div></div>  <!-- /segment-header -->	

	<div id="segment-navbar" class="segment">  <!-- segment-navbar -->
		<div id="stripe"> </div>
		<div class="container">  <!-- container -->
   <!-- HEADER CONTENT -->
 	      		
 	      		      		
			<nav class="navbar navbar-inverse">
				<div class="container">
					<button data-target=".navbar-inverse-collapse" class="navbar-toggle" data-toggle="collapse" type="button">
						<span class="icon-bar"> </span>
						<span class="icon-bar"> </span>
						<span class="icon-bar"> </span>
					</button>
					<a class="navbar-brand hidden" href="index.html">CQL</a>
					<div class="nav-collapse collapse navbar-inverse-collapse">
						<ul class="nav navbar-nav">
              <li><a href="index.html">Documentation</a></li>
              <li><a href="grammar.html">Grammar</a></li>
			  <li><a href="elm.html">ELM</a></li>
			  <li><a href="examples.html">Examples</a></li>
              <li><a href="tests.html">Tests</a></li>
              <li><a href="../history.html">Version History</a><!--current--></li>

						</ul>
					</div>  <!-- /.nav-collapse -->

          </div>  <!-- /.container -->
			</nav>  <!-- /.navbar -->
      		
				
  <!-- /HEADER CONTENT -->				
		</div>  <!-- /container -->
	</div>  <!-- /segment-navbar -->
	
	<div id="segment-content" class="segment">  <!-- segment-content -->
	<div class="container">  <!-- container -->
            <div class="row">
            	<div class="inner-wrapper">
  <!-- CONTENT CONTENT -->


<div class="col-9">
    
<table class="cols"><tbody><tr><td id="wg"><a href="http://www.hl7.org/special/committees/dss/index.cfm" _target="blank">Clinical Decision Support</a> Work Group</td><td id="fmm"><a href="http://hl7.org/fhir/resource.html#maturity">Maturity Level</a>: 4</td><td id="ballot"><a href="http://hl7.org/fhir/help.html#status">Ballot Status</a>: STU 2.1</a></td></tr></tbody></table>
    
<h1>4. Logical Specification</h1>
    
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#expressions">1. Expressions</a></li>
<li><a href="#simple-values-1">2. Simple Values</a></li>
<li><a href="#comparison-operators-1">3. Comparison Operators</a></li>
<li><a href="#logical-operators-1">4. Logical Operators</a></li>
<li><a href="#nullological-operators-1">5. Nullological Operators</a></li>
<li><a href="#conditional-operators">6. Conditional Operators</a></li>
<li><a href="#arithmetic-operators-1">7. Arithmetic Operators</a></li>
<li><a href="#string-operators-1">8. String Operators</a></li>
<li><a href="#date-and-time-operators">9. Date and Time Operators</a></li>
<li><a href="#interval-operators">10. Interval Operators</a></li>
<li><a href="#structured-values">11. Structured Values</a></li>
<li><a href="#list-values-1">12. List Values</a></li>
<li><a href="#aggregate-operators-1">13. Aggregate Operators</a></li>
<li><a href="#type-specifiers-and-operators">14. Type Specifiers and Operators</a></li>
<li><a href="#queries-2">15. Queries</a></li>
<li><a href="#reusing-logic">16. Reusing Logic</a></li>
<li><a href="#external-data">17. External Data</a></li>
<li><a href="#clinical-operators-1">18. Clinical Operators</a></li>
<li><a href="#parameters-1">19. Parameters</a></li>
<li><a href="#data-model">20. Data Model</a></li>
<li><a href="#libraries-2">21. Libraries</a></li>
<li><a href="#errors-and-messages">22. Errors and Messages</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes the Expression Logical Model (ELM) and how it is used to represent clinical knowledge within a quality artifact.</p>
</div>
<div class="paragraph">
<p>The ELM defines a mechanism for representing artifact logic independent of syntax and special-purpose constructs introduced at the syntactic level. ELM is equivalent to CQL syntax in terms of expressive power: every possible expression in CQL has an equivalent canonical-form expression in ELM. Higher-level constructs such as timing phrases and implicit conversions are represented in terms of the more primitive operators in ELM. This takes the burden of interpretation of higher-level constructs off of implementers, allowing them to focus on the implementation of a more primitive set of functionality.</p>
</div>
<div class="paragraph">
<p>Expressions within ELM are represented as Abstract Syntax Trees. ELM defines the base <em>Expression</em> class, and all language elements and operators are then defined as descendants of the base <em>Expression</em>. For example, the <em>Add</em> class descends from <em>BinaryExpression</em>, which introduces two operands, each of type <em>Expression</em>. The <em>Literal</em> class descends from <em>Expression</em> and allows primitive-typed values such as strings and integers to be represented directly. Using these classes, the expression 2 + 2 can be represented as instances of the appropriate classes:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="extracted-media/media/image10.png" alt="image" width="107" height="99"/></span></p>
</div>
<div class="paragraph">
<p>Figure 4‑A</p>
</div>
<div class="paragraph">
<p>By combining instances of the appropriate classes of ELM, the logic for any expression can be represented. Note that the type of the expression can be inferred from the representation, Integer in this example.</p>
</div>
<div class="paragraph">
<p>The ELM consists of the following components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Expression – This component defines the core structures for representing expressions, as well as the operations available within those expressions.</p>
</li>
<li>
<p>Clinical Expression – This component extends the Expression component to introduce expressions specific to the clinical quality domain.</p>
</li>
<li>
<p>Library – This component defines the structure of a library, the container, and the basic unit of sharing.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each of these components is defined fully within the ELM UML model. This model is defined formally as an XMI, and the model definition is also presented as an Enterprise Architect Project file (.eap) for viewing.</p>
</div>
<div class="paragraph">
<p>The documentation provided here serves only as a high-level structural reference for the ELM. The actual content of the specification is defined by the XMI file, and that provides the “source-of-truth” for the ELM specification.</p>
</div>
<div class="paragraph">
<p>Note that the semantics for the operations described here are defined both in the UML model as comments on the node for each operator, as well as the equivalent CQL operation as defined in Appendix B – CQL Reference.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="expressions"><a class="anchor" href="#expressions"></a>1. Expressions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The ELM Expression component defines a mechanism for representing the structure of logic. The following table lists the core elements defined by the ELM:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Expression</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Expression</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Abstract base class for all expressions in ELM</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UnaryExpression</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Abstract base class for unary expressions in ELM</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BinaryExpression</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Abstract base class for binary expressions in ELM</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TernaryExpression</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Abstract base class for ternary expressions in ELM</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NaryExpression</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Abstract base class for n-ary expressions in ELM</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Table 4‑A</p>
</div>
<div class="paragraph">
<p>Every expression in ELM is represented as a descendant of the abstract base element <em>Expression</em>. In addition, several abstract descendants are introduced to support the representation of unary, binary, ternary, and n-ary operators. Note that an expression need not descend from one of these descendants, it may descend from <em>Expression</em> directly.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="simple-values-1"><a class="anchor" href="#simple-values-1"></a>2. Simple Values</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Support for simple values is provided by the <em>Literal</em> class. This class defines properties to represent the type of the value, as well as the value itself.</p>
</div>
<div class="paragraph">
<p>The following table lists the simple value classes available in ELM:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Expression</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Literal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Represents simple value literals</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Table 4‑B</p>
</div>
<div class="paragraph">
<p>The <em>Literal</em> class is used to represent values for simple primitive types: Boolean, String, Integer, Decimal, DateTime, and Time.</p>
</div>
<div class="paragraph">
<p>The result type of a <em>Literal</em> is the type of the primitive being represented.</p>
</div>
<div class="paragraph">
<p>For more information on the primitive types, see the Types section in the CQL Reference.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="comparison-operators-1"><a class="anchor" href="#comparison-operators-1"></a>3. Comparison Operators</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ELM defines a standard set of comparison operators for use with simple values. Each comparison operator takes two arguments of the same type, and returns a boolean indicating the result of the comparison. Note that for comparison operators, if either or both operands evaluate to null, the result of the comparison is <em>null</em>, not false.</p>
</div>
<div class="paragraph">
<p>The following table lists the comparison operators available in ELM:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Expression</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Equal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the operands are equal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Equivalent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the operands are equivalent</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NotEqual</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the operands are not equal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Less</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the first operand is less than the second operand</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LessOrEqual</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the first operand is less than or equal to the second operand</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Greater</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the first operand is greater than the second operand</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GreaterOrEqual</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the first operand is greater than or equal to the second operand</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Table 4‑C</p>
</div>
<div class="paragraph">
<p>The following example illustrates a simple <em>Equal</em> comparison:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="extracted-media/media/image11.png" alt="image" width="109" height="102"/></span></p>
</div>
<div class="paragraph">
<p>Figure 4‑B</p>
</div>
<div class="paragraph">
<p>For more information on the semantics of the various comparison operators, see the Comparison Operators section of the CQL Reference.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="logical-operators-1"><a class="anchor" href="#logical-operators-1"></a>4. Logical Operators</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ELM defines logical operators that can be used to combine the results of logical expressions. <em>And</em> and <em>Or</em> can be used to combine any number of results, and <em>Not</em> can be used to invert the result of any expression.</p>
</div>
<div class="paragraph">
<p>Note that these operators are defined with 3-valued logic semantics, allowing the operators to deal consistently with missing information.</p>
</div>
<div class="paragraph">
<p>The following table lists the logical operators available in ELM:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Expression</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">And</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the logical conjunction of its operands</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Or</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the logical disjunction of its operands</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the logical negation of its operand</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Implies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the logical implication of its operands</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Xor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the exclusive or of its operands</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Table 4‑D</p>
</div>
<div class="paragraph">
<p>The following example illustrates a simple <em>And</em> expression:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="extracted-media/media/image12.png" alt="image" width="138" height="217"/></span></p>
</div>
<div class="paragraph">
<p>Figure 4‑C</p>
</div>
<div class="paragraph">
<p>For more information on the semantics of these operators, refer to the Logical Operators section in the CQL Reference.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="nullological-operators-1"><a class="anchor" href="#nullological-operators-1"></a>5. Nullological Operators</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ELM defines several nullological operators that are useful for dealing with potentially missing information. These are <em>Null, IsNull</em>, <em>IsTrue</em>, <em>IsFalse</em>, and <em>Coalesce</em>.</p>
</div>
<div class="paragraph">
<p>The following table lists the logical operators available in ELM:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Expression</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a typed null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IsNull</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the argument is <em>null</em>, false otherwise</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IsTrue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the argument is <em>true</em>, false otherwise</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IsFalse</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the argument is <em>false</em>, false otherwise</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coalesce</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the first non-null argument, null if there are no non-null arguments</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Table 4‑E</p>
</div>
<div class="paragraph">
<p>For more information on the semantics of these operators, refer to the Nullological Operators section in the CQL Reference.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="conditional-operators"><a class="anchor" href="#conditional-operators"></a>6. Conditional Operators</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ELM defines several conditional expressions that can be used to return different values based on a condition, or set of conditions. These are the <em>If</em> (conditional) expression, and the <em>Case</em> expression.</p>
</div>
<div class="paragraph">
<p>The conditional expression allows a simple condition to be used to decide between one expression or another.</p>
</div>
<div class="paragraph">
<p>The case expression has two varieties, one that is equivalent to repeated conditionals, and one that allows a specific comparand to be identified and compared with each item to determine a result.</p>
</div>
<div class="paragraph">
<p>The following table lists the conditional operators available in ELM:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Expression</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">If</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows for conditional evaluation between two expressions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Case</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows for multiple conditional expressions, or a comparand with multiple cases.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Table 4‑F</p>
</div>
<div class="paragraph">
<p>The following examples illustrates a simple <em>If</em> expression (i.e. if / then / else):</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="extracted-media/media/image13.png" alt="image" width="143" height="193"/></span></p>
</div>
<div class="paragraph">
<p>Figure 4‑D</p>
</div>
<div class="paragraph">
<p>The following example illustrates a more complex multi-conditional <em>Case</em> expression:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="extracted-media/media/image14.png" alt="image" width="230" height="397"/></span></p>
</div>
<div class="paragraph">
<p>Figure 4‑E</p>
</div>
<div class="paragraph">
<p>And finally, an equivalent comparand-based <em>Case</em> expression:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="extracted-media/media/image15.png" alt="image" width="184" height="286"/></span></p>
</div>
<div class="paragraph">
<p>Figure 4‑F</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="arithmetic-operators-1"><a class="anchor" href="#arithmetic-operators-1"></a>7. Arithmetic Operators</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ELM provides a complete set of arithmetic operators to allow for manipulation of integer and real values within artifacts. In general, these operators have the expected semantics for arithmetic operators.</p>
</div>
<div class="paragraph">
<p>Note that if an operand evaluates to null, the result of the operation is defined to be null. This provides consistent semantics when dealing with missing information.</p>
</div>
<div class="paragraph">
<p>The following table lists the arithmetic operators available in ELM:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Expression</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Performs numeric addition of its arguments</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Subtract</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Performs numeric subtraction of its arguments</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multiply</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Performs numeric multiplication of its arguments</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Divide</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Performs numeric division of its arguments</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TruncatedDivide</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Performs integer division of its arguments</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Modulo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Computes the remainder of the division of its arguments</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ceiling</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the first integer greater than or equal to its argument</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Floor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the first integer less than or equal to its argument</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Truncate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the integer component of its argument</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Abs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the absolute value of its argument</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Negate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the negative value of its argument</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Round</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the nearest numeric value to its argument, optionally specified to a number of decimal places for rounding</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ln</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Computes the natural logarithm of its argument</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Computes the logarithm of its first argument, using the second argument as the base</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Raises e to the power given by its argument</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Power</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Raises the first argument to the power given by the second argument</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Successor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the successor of its argument</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Predecessor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the predecessor of its argument</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MinValue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the minimum representable value for a type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MaxValue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the maximum representable value for a type</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Table 4‑G</p>
</div>
<div class="paragraph">
<p>The following example illustrates a simple <em>Add</em> expression:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="extracted-media/media/image16.png" alt="image" width="102" height="94"/></span></p>
</div>
<div class="paragraph">
<p>Figure 4‑G</p>
</div>
<div class="paragraph">
<p>For more information on the semantics of these operators, refer to the Arithmetic Operators section in the CQL Reference.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="string-operators-1"><a class="anchor" href="#string-operators-1"></a>8. String Operators</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ELM defines a set of string operators to allow for manipulation of string values within artifact definitions.</p>
</div>
<div class="paragraph">
<p>Indexes within strings are defined to be 0-based.</p>
</div>
<div class="paragraph">
<p>Note that except as noted within the documentation for each operator, if any argument evaluates to null, the result of the operation is also defined to be null.</p>
</div>
<div class="paragraph">
<p>The following table lists the string operators available in ELM:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Expression</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Concatenate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the concatenation of its arguments</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Combine</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Combines a list of strings, optionally separating them with the given separator</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">StartsWith</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the string starts with a given prefix</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EndsWith</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the string ends with a given suffix</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Split</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Splits a string into a list of strings along a given separator</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LastPositionOf</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the starting position of the last appearance of a given pattern</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Length</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the length of its argument</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Matches</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the string matches a given regular expression pattern</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ReplaceMatches</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Replaces matches of a given pattern with a given substitution</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Upper</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the upper case representation of its argument</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Lower</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the lower case representation of its argument</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indexer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the nth character of its argument</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PositionOf</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the starting position of a given pattern within a string</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Substring</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a substring of its argument</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Table 4‑H</p>
</div>
<div class="paragraph">
<p>For more information on the semantics of these operators, refer to the String Operators section in the CQL Reference.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="date-and-time-operators"><a class="anchor" href="#date-and-time-operators"></a>9. Date and Time Operators</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ELM defines several operators for representating the manipulation of date and time values. These operators are defined using a common precision type that allows the various precisions (e.g. day, month, week, hour, minute, second) of time to be manipulated.</p>
</div>
<div class="paragraph">
<p>Except as noted within the documentation for each operator, if any argument evaluates to null, the result of the operation is also defined to be null.</p>
</div>
<div class="paragraph">
<p>The following table lists the date and time operators available in ELM:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Expression</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DateTimeComponentFrom</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a specified component of its argument</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Today</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the date (with no time components specified) of the start timestamp associated with the evaluation request</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Now</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the date and time of the start timestamp associated with the evaluation request</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TimeOfDay</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the time-of-day of the start timestamp associated with the evaluation request</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DateTime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructs a date/time value from its arguments</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructs a time value from its arguments</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DateFrom</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the date (with no time component) of the argument</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TimeFrom</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the time of the argument</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TimezoneFrom</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the timezone offset (in hours) of the argument</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SameAs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Performs precision-based equality comparison of two date/time values</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SameOrBefore</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Performs precision-based less-or-equal comparison of two date/time values</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SameOrAfter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Performs precision-based greater-or-equal comparison of two date/time values</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Before</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Performs precision-based less-than comparison of two date/time values</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">After</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Performs precision-based greater-than comparison of two date/time values</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DurationBetween</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Computes the number of whole periods between two dates</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DifferenceBetween</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Computes the number of whole period boundaries crossed between two dates</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Table 4‑I</p>
</div>
<div class="paragraph">
<p>For more information on the semantics of these operators, refer to the Date/Time Operators section in the CQL Reference.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="interval-operators"><a class="anchor" href="#interval-operators"></a>10. Interval Operators</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ELM defines a complete set of operators for use in defining and manipulating interval values.</p>
</div>
<div class="paragraph">
<p>Constructing an interval is performed with the <em>Interval</em> expression, which allows the beginning and ending of the interval to be specified, as well as whether the interval beginning and ending is exclusive (open), or inclusive (closed).</p>
</div>
<div class="paragraph">
<p>ELM defines support for basic operations on intervals including determining length, accessing interval properties, and determining interval boundaries.</p>
</div>
<div class="paragraph">
<p>ELM also supports complete operations involving comparisons of intervals, including equality, membership testing, and inclusion testing.</p>
</div>
<div class="paragraph">
<p>In addition, the language supports operators for combining and manipulating intervals.</p>
</div>
<div class="paragraph">
<p>The following table provides a complete listing of the interval operators available in ELM:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Expression</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructs a new interval value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Equal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the arguments are the same interval</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NotEqual</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the arguments are not the same interval</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Equivalent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the intervals are equivalent</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the interval contains the given point</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">In</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the given point is in the interval</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Includes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the first interval completely includes the second (i.e., starts on or before and ends on or after)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IncludedIn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the first interval is completely included in the second (i.e., starts on or after and ends on or before)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ProperIncludes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the first interval completely includes the second and the first interval is strictly larger (i.e., includes and not equal)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ProperIncludedIn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the first interval is completely included in the second and the second interval is strictly larger (i.e., included in and not equal)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Before</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the first interval ends before the second one starts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">After</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the first interval starts after the second one ends</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SameOrBefore</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the first interval ends on or before the second one starts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SameOrAfter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the first interval starts on or after the second one ends</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Meets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the first interval ends immediately before the second interval starts, or if the first interval starts immediately after the second interval ends</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MeetsBefore</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the first interval ends immediately before the second interval starts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MeetsAfter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the first interval starts immediately after the second interval ends</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Overlaps</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the first interval overlaps the second</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OverlapsBefore</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the first interval starts before and overlaps the second</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OverlapsAfter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the first interval ends after and overlaps the second</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Union</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the interval that results from combining the arguments</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Intersect</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the interval that results from the intersection of the arguments</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Except</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the interval that results from subtracting the second interval from<br/>
the first</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Length</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the length of the interval</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Start</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the starting point of the interval</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">End</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the ending point of the interval</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Starts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the first interval starts the second</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ends</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the first interval ends the second</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Collapse</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the unique set of intervals that completely cover the range covered by the given intervals</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Width</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the width of the interval</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PointFrom</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extracts a single point from a unit interval. If the interval is wider than one, an error is thrown</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Table 4‑J</p>
</div>
<div class="paragraph">
<p>Note that ELM does not include a definition for During because it is synonymous with IncludedIn.</p>
</div>
<div class="paragraph">
<p>For more information on the semantics of these operators, refer to the Interval Operators section in the CQL Reference.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="structured-values"><a class="anchor" href="#structured-values"></a>11. Structured Values</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Structured values in ELM are values with sets of named elements (tuples), each of which may have a value of any type. Structured values are most commonly used to represent clinical information such as encounters, problems, and procedures.</p>
</div>
<div class="paragraph">
<p>The <em>Tuple</em> class represents construction of a new structured value, with the values for each element supplied by <em>TupleElement</em> instances.</p>
</div>
<div class="paragraph">
<p>To access elements of a structured value, use the <em>Property</em> expression. A property expression has a <em>path</em> attribute, an optional <em>source</em> element, and a <em>value</em> element. The source element returns the structured value to be accessed. In some contexts, such as within a <em>Filter</em> expression, the source is implicit. If used outside such a context, a source must be provided.</p>
</div>
<div class="paragraph">
<p>The path attribute specifies a property path relative to the source structured value. The property expression returns the value of the property specified by the property path. Property paths are allowed to include qualifiers (.) as well as indexers ([x]) to indicate that subelements should be traversed. Indexers specified in paths must be literal integer values.</p>
</div>
<div class="paragraph">
<p>The following table lists the structured value operators available in ELM:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Expression</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tuple</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructs a new tuple value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Instance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructs a new instance of a structured value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the value of an element of a structured value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Equal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if its arguments are equal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NotEqual</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retruns true if its arguments are not equal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Equivalent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if its arguments are equivalent</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Table 4‑K</p>
</div>
<div class="paragraph">
<p>The following example illustrates the construction of a tuple using the <em>Tuple</em> class:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="extracted-media/media/image17.png" alt="image" width="190" height="157"/></span></p>
</div>
<div class="paragraph">
<p>Figure 4‑H</p>
</div>
<div class="paragraph">
<p>The following example illustrates the construction of a structured value using the <em>Instance</em> class:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="extracted-media/media/image18.png" alt="image" width="184" height="152"/></span></p>
</div>
<div class="paragraph">
<p>Figure 4‑I</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="list-values-1"><a class="anchor" href="#list-values-1"></a>12. List Values</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ELM allows for the expression and manipulation of lists of values of any type. The most basic list operation is the <em>List</em> class, which represents a simple list selector.</p>
</div>
<div class="paragraph">
<p>Basic list operations include testing for membership, indexing, and content. ELM also supports comparison of lists, including equality and inclusion determination (subset/superset). Supported operations on single lists include filtering, sorting, and computation. For multiple lists, ELM supports combining through union and intersection, as well as computing the difference.</p>
</div>
<div class="paragraph">
<p>The use of the scope attribute allows for more complex expressions such as correlated subqueries.</p>
</div>
<div class="paragraph">
<p>ELM also supports a flattening operator, <em>Flatten</em> to construct a single list from a list of lists.</p>
</div>
<div class="paragraph">
<p>The following table provides a complete listing of the list operators available in ELM:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Expression</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">List</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructs a list from its arguments</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exists</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if its argument contains any elements</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Equal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if its arguments have the same number of elements, and for each element considered in order, the elements are equal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NotEqual</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if its arguments are not equal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Equivalent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if its arguments are equivalent</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Union</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a list containing all the unique elements of its arguments</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Except</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a list containing only the elements in the first list that are not in the second list</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Intersect</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a list containing only the elements that are in all of its arguments</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Times</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Combines the elements from two lists, returning a list with an element for each possible combination of elements from the source list.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Filter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a list containing only the elements for which the given condition evaluates to true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SingletonFrom</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extracts the single element from a list with at most one element.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IndexOf</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the 0-based index of an element within the list, or 0 if the element is not present</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indexer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the element at the given 0-based index in the list</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">In</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the given element is in a given list</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the given list contains a given element</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Includes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if every element in the second list is in the first list</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IncludedIn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if every element in the first list is in the second list</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ProperIncludes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if every element in the second list is in the first list, and the first list is strictly larger than the second</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ProperIncludedIn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the second list contains every element in the first list, and the second list is strictly larger than the first</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a list with the same elements, sorted by the given sort criteria</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForEach</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a list whose elements are determined by evaluating a given expression for each element in its argument</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Flatten</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Flattens a list of lists into a single list with all the elements from every list in the input. Duplicates are not eliminated by this operation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Distinct</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a list that contains the unique elements within its argument</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Current</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the contents of the current scope</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">First</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the first element in the given list</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Last</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the last element in the given list</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Slice</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a portion of the elements in the given list, beginning at a startIndex and ending just before an endIndex</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Repeat</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a list whose elements are determined by evaluating a given expression for each element in the argument, and repeating the evaluation on the resulting list until no new elements are returned</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Table 4‑L</p>
</div>
<div class="paragraph">
<p>For more information on the semantics of these operators, refer to the List Operators section in the CQL Reference.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="aggregate-operators-1"><a class="anchor" href="#aggregate-operators-1"></a>13. Aggregate Operators</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For computing aggregate quantities, ELM defines several aggregate operators. These operators perform computations on lists of values, either on the elements of the list directly, or on a specific property of each element in the list.</p>
</div>
<div class="paragraph">
<p>Unless noted in the documentation for each operator, aggregate operators deal with missing information by excluding elements which have no value before performing the aggregation. In addition, an aggregate operation performed over an empty list is defined to return null, except as noted in the documentation for each operator (e.g. Count).</p>
</div>
<div class="paragraph">
<p>The following table lists the aggregate operators available in ELM:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Expression</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Count</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the number of non-null elements in the source</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sum</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Computes the sum of non-null elements in the source</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Min</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the minimum element in the source</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Max</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the max element in the source</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Avg</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the average of the elements in the source</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Median</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the median of the elements in the source</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the mode of the elements in the source</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Variance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the statistical variance of the elements in the source</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PopulationVariance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the population variance of the elements in the source</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">StdDev</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the standard deviation of the elements in the source</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PopulationStdDev</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the population standard deviation of the elements in the source</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AllTrue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if all the non-null elements in source are true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AnyTrue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if any non-null element in source is true</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Table 4‑M</p>
</div>
<div class="paragraph">
<p>For more information on the semantics of these operators, refer to the Aggregate Functions section in the CQL Reference.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="type-specifiers-and-operators"><a class="anchor" href="#type-specifiers-and-operators"></a>14. Type Specifiers and Operators</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ELM provides the following elements for type specifiers, testing, casting, and conversion:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Element</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Is</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the type of the argument is the given type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">As</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the argument as the type if it is of the given type, null otherwise</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Convert</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the argument converted to the given type, if possible. If no conversion is possible, a run-time error is thrown</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NamedTypeSpecifier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a named type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IntervalTypeSpecifier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies an interval type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ListTypeSpecifier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a list type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TupleTypeSpecifier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a tuple type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Children</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the values of all immediate children of the source</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Descendents</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the values of all children of the source, recursively</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Table 4‑N</p>
</div>
<div class="paragraph">
<p>For more information on the semantics of these operators, refer to the Type Operators section in the CQL Reference.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="queries-2"><a class="anchor" href="#queries-2"></a>15. Queries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ELM provides a mechanism for expressing the structure of a query using the following classes:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Class</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Query</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines a query in ELM, containing clauses as defined by the other elements in this section.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AliasedQuerySource</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The AliasedQuerySource element defines a single source for inclusion in the query context. The type of the source is determined by the expression element, and the source can be accessed within the query context by the given alias.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LetClause</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The LetClause element allows any number of expression definitions to be introduced within a query context. Defined expressions can be referenced by name within the query context.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">With</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The With clause restricts the elements of a given source to only those elements that have elements in the related source that satisfy the suchThat condition. This operation is known as a semi-join in database languages.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Without</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Without clause restricts the elements of a given source to only those elements that do not have elements in the related source that satisfy the suchThat condition. This operation is known as a semi-difference in database languages.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SortClause</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The SortClause element defines the sort order for the query, and is made up of any number of elements that are descendants of the SortByItem class (ByDirection, ByColumn, or ByExpression).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ByDirection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates that the sort should be performed ascending or descending. This sortByItem can only appear by itself in a sort clause, and is used when the query is based on a list of non-tuple-valued elements.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ByColumn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates that the sort should be performed based on the values of a specified column.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ByExpression</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates that the sort should be performed based on the result of an expression.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ReturnClause</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The ReturnClause element defines the shape of the result set of the query.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AliasRef</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Within a Query, references a defined alias</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">QueryLetRef</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Within a Query, references an introduced let expression</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Table 4‑O</p>
</div>
<div class="paragraph">
<p>For more information on query semantics, refer to the Queries section of the Author’s Guide, as well as the Multi-Source Queries and Non-Retrieve Queries sections of the Developer’s Guide.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="reusing-logic"><a class="anchor" href="#reusing-logic"></a>16. Reusing Logic</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ELM provides a mechanism for reusing expressions by declaring a named expression. This construct is similar to a function call with no parameters in a traditional imperative language, with the exception that since ELM is a pure-functional system, the result of the evaluation could be cached by an implementation to avoid performing the same computation multiple times.</p>
</div>
<div class="paragraph">
<p>In addition, ELM provides a more traditional function call with named parameters that can then be accessed by the expression in the function body, and passed as part of the call from the invoking context.</p>
</div>
<div class="paragraph">
<p>The <em>ExpressionDef</em> class is used to define a named expression that can then be referenced by other expressions. The <em>FunctionDef</em> class is used to define a function and its parameters.</p>
</div>
<div class="paragraph">
<p>Note that circular expression references are not allowed, but that named expressions can be defined in any order, so long as the actual references do not result in a cycle.</p>
</div>
<div class="paragraph">
<p>The following table lists the expression definition components available in ELM:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Expression</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ExpressionDef</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines a named expression that can be referenced by other expressions</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ExpressionRef</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the result of evaluating a named expression</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FunctionDef</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines a function that can be referenced by other expressions, or within the body of other functions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FunctionRef</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the result of evaluating a function with the given arguments</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Table 4‑P</p>
</div>
<div class="paragraph">
<p>The <em>ExpressionDef</em> class introduces the notion of <em>context</em> which can be either Patient or Population. This context defines how the contained expression is evaluated, either with respect to a single patient, defined by the evaluation environment, or with respect to a population. For more information about patient context, please refer to the External Data section.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="external-data"><a class="anchor" href="#external-data"></a>17. External Data</h2>
<div class="sectionbody">
<div class="paragraph">
<p>All access to external data within ELM is represented by <em>Retrieve</em> expressions.</p>
</div>
<div class="paragraph">
<p>The <em>Retrieve</em> class defines the data type of the request, which determines the type of elements to be returned. The result will always be a list of values of the type specified in the request.</p>
</div>
<div class="paragraph">
<p>The type of the elements to be returned is specified with the <em>dataType</em> attribute of the <em>Retrieve</em>, and must refer to the name of a type within a known data model specified in the <em>dataModels</em> element of the library definition.</p>
</div>
<div class="paragraph">
<p>In addition, the <em>Retrieve</em> introduces the ability to specify optional criteria for the request. The available criteria are intentionally restricted to the set of codes involved, and the date range involved. If these criteria are omitted, the request is interpreted to mean all data of that type.</p>
</div>
<div class="paragraph">
<p>Note that because every expression is being evaluated within a context (either Patient or Population) as defined by the containing <em>ExpressionDef</em>, the data returned by a retrieve depends on the context. For the Patient context, the data is returned for a single patient only, as defined by the evaluation environment. Whereas for the Population context, the data is returned for all patients.</p>
</div>
<div class="paragraph">
<p>The following table lists the expressions relevant to defining external data in ELM:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Expression</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retrieve</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines clinical data that will be used within the artifact</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Table 4‑Q</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="clinical-operators-1"><a class="anchor" href="#clinical-operators-1"></a>18. Clinical Operators</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For working with clinical data, ELM defines operators for terminology sets, quantities, and calculating age.</p>
</div>
<div class="paragraph">
<p>The following table lists the classes representing clinical information in ELM:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Class</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CodeSystemDef</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines a code system identifier that can be referenced by name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CodeSystemRef</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">References a code system by its previously defined name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">InCodeSystem</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tests a string, code, or concept for membership in a codesystem</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ValueSetDef</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines a valueset identifier that can be referenced by name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ValueSetRef</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">References a valueset by its previously defined name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">InValueSet</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tests a string, code, or concept for membership in a valueset</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CodeDef</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines a code identifier that can be referenced by name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CodeRef</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">References a code by its previously defined name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ConceptDef</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines a concept identifier that can be referenced by name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ConceptRef</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">References a concept by its previously defined name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Selects an existing code from a defined codesystem</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Concept</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Selects an existing concept containing a list of codes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quantity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a clinical quantity with a specified unit</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CalculateAge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Calculates the age in the specified precision of a person born on the given date as of today.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CalculateAgeAt</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Calculates the age in the specified precision of a person born on the first date as of the second date.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Table 4‑R</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="parameters-1"><a class="anchor" href="#parameters-1"></a>19. Parameters</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In addition to external data, ELM provides a mechanism for defining parameters to an artifact. A library can define any number of parameters, each of which has a name, and a defined type, as well as an optional default value.</p>
</div>
<div class="paragraph">
<p>Parameter values, if any, are expected to be provided as part of the evaluation request, and can be accessed with a <em>ParameterRef</em> expression in any expression throughout the library.</p>
</div>
<div class="paragraph">
<p>The following table lists the expressions relevant to parameters in ELM:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Expression</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ParameterDef</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines a parameter to the artifact</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ParameterRef</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the value of a parameter</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Table 4‑S</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="data-model"><a class="anchor" href="#data-model"></a>20. Data Model</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ELM does not reference any specific data model, and so can be used to represent logic expressed against any data model. These data models are specified using the <em>UsingDef</em> class. This class provides attributes for specifying the name and version of the data model. An ELM library can reference any number of models.</p>
</div>
<div class="paragraph">
<p>The name of the model is an implementation-specific identifier that provides the environment with a mechanism for finding the model description. The details of how that model description is provided are part of the physical representation.</p>
</div>
<div class="paragraph">
<p>The following table lists the elements relevant to data models in ELM:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Element</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UsingDef</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines a data model that can be used by expressions within the library</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Table 4‑T</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="libraries-2"><a class="anchor" href="#libraries-2"></a>21. Libraries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ELM defines the notion of a library as the basic container for logic constructs. Libraries consist of sets of declarations including data model references, library references, valueset definitions, parameters, functions, and named expressions. The <em>Library</em> class defines this unit and defines properties for each of these types of declarations.</p>
</div>
<div class="paragraph">
<p>Once defined, libraries can then be referenced by other libraries with the <em>IncludeDef</em> class, which defines properties for the name and version of the library being referenced, as well as a local name that is used to access components of the library.</p>
</div>
<div class="paragraph">
<p>The following table lists the elements relevant to libraries in ELM:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Element</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IncludeDef</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines a library reference; public components of the included library can be referenced by components of the referencing library.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VersionedIdentifier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the versioned identifier construct used to label the various declarations throughout ELM</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Table 4‑U</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="errors-and-messages"><a class="anchor" href="#errors-and-messages"></a>22. Errors and Messages</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ELM defines a utility operation that is useful for generating run-time messages, warnings, traces, and errors. The operator is a single, general-purpose function intended to provide a single implementation point for messaging and run-time error functionality when those messages are generated from ELM logic.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Element</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides a mechanism for generating and returning messages, warnings, errors, and traces to the calling environment.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The source parameter is always a generic value, which is always the result of the operator and is purely passthrough. This allows the operation to appear at any point in any expression of ELM.</p>
</div>
<div class="paragraph">
<p>The optional condition parameter determines whether or not the message is generated. If no condition is supplied, the default is true and the message is generated.</p>
</div>
<div class="paragraph">
<p>There is an optional code parameter which allows a coded representation of the message. (Note this is an error token such as an integer or string, not a clinical terminology Code).</p>
</div>
<div class="paragraph">
<p>There is an optional severity parameter which allows the severity of the message to be specified, one of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Message – The operation produces an informational message that is expected to be made available in some way to the calling environment.</p>
</li>
<li>
<p>Warning – The operation produces a warning message that is expected to be made conspicuously available to the calling environment, potentially to the end-user of the logic.</p>
</li>
<li>
<p>Trace – The operation produces an informational message that is expected to be made available to a tracing mechanism such as a debug log in the calling environment.</p>
</li>
<li>
<p>Error – The operation produces a run-time error and return the message to the calling environment. This is the only severity that stops evaluation. All other severities continue evaluation of the expression.</p>
<div class="paragraph">
<p>If no severity is supplied, a default severity of Message is assumed.</p>
</div>
</li>
</ul>
</div>
</div>
</div>


</div>


				</div>  <!-- /inner-wrapper -->
            </div>  <!-- /row -->
        </div>  <!-- /container -->
        
    </div>  <!-- /segment-content -->


	<div id="segment-footer" class="segment">  <!-- segment-footer -->
		<div class="container">  <!-- container -->
			<div class="inner-wrapper">
				<p>
        &copy; HL7.org 2014+. CQL STU2.1 (1.2 Published w/ Errata) generated on 2019-03-17 11:17:12 -0600
        <span style="color: #FFFF77">| 
               <a style="color: #81BEF7" rel="license" href="license.html">License</a> |
               <a style="color: #81BEF7" target="_blank" href="http://www.hl7.org/implement/standards/product_brief.cfm?product_id=400">Propose a change</a>
        </span>
        </p>
			</div>  <!-- /inner-wrapper -->
		</div>  <!-- /container -->
	</div>  <!-- /segment-footer -->

	
	<div id="segment-post-footer" class="segment hidden">  <!-- segment-post-footer -->
		<div class="container">  <!-- container -->
		</div>  <!-- /container -->
	</div>  <!-- /segment-post-footer -->
    
      <!-- JS and analytics only. -->
      <!-- Bootstrap core JavaScript
================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
<script src="dist/jquery.js"> </script>     <!-- note keep space here, otherwise it will be transformed to empty tag -> fails -->
<script src="dist/bootstrap.min.js"> </script>
<script src="dist/respond.min.js"> </script>

<script src="dist/fhir.js"> </script>

  <!-- Analytics Below
================================================== -->


<div id="feedly-mini" title="feedly Mini tookit"></div></body></html>